!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],t):"object"==typeof exports?exports.RTMP=t(require("Clappr")):e.RTMP=t(e.Clappr)}(this,function(e){return function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([/*!******************!*\
  !*** ./index.js ***!
  \******************/
function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i(/*! ./src/main.js */1),e.exports=t["default"]},/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e,t,i){for(var n=!0;n;){var s=e,a=t,o=i;n=!1,null===s&&(s=Function.prototype);var r=Object.getOwnPropertyDescriptor(s,a);if(void 0!==r){if("value"in r)return r.value;var l=r.get;if(void 0===l)return;return l.call(o)}var u=Object.getPrototypeOf(s);if(null===u)return;e=u,t=a,i=o,n=!0,r=u=void 0}},l=i(/*! clappr */2),u=i(/*! ../public/flash.html */3),p=n(u),h=i(/*! raw!sass!../public/flash.scss */4),c=n(h),f=function(e){function t(e){s(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.options.rtmpConfig=this.options.rtmpConfig||{},this.options.rtmpConfig.swfPath=this.options.rtmpConfig.swfPath||"//cdn.jsdelivr.net/clappr.rtmp/latest/assets/RTMP.swf",this.options.rtmpConfig.wmode=this.options.rtmpConfig.wmode||"transparent",this.options.rtmpConfig.bufferTime=void 0===this.options.rtmpConfig.bufferTime?.1:this.options.rtmpConfig.bufferTime,this.options.rtmpConfig.scaling=this.options.rtmpConfig.scaling||"letterbox",this.options.rtmpConfig.playbackType=this.options.rtmpConfig.playbackType||this.options.src.indexOf("live")>-1,this.options.rtmpConfig.startLevel=void 0===this.options.rtmpConfig.startLevel?-1:this.options.rtmpConfig.startLevel,this.addListeners(),this._setupPlaybackType()}return a(t,e),o(t,[{key:"name",get:function(){return"rtmp"}},{key:"tagName",get:function(){return"object"}},{key:"template",get:function(){return(0,l.template)(p["default"])}},{key:"attributes",get:function(){return{"data-rtmp":"",type:"application/x-shockwave-flash",width:"100%",height:"100%"}}}]),o(t,[{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"addListeners",value:function(){l.Mediator.on(this.uniqueId+":progress",this._progress,this),l.Mediator.on(this.uniqueId+":timeupdate",this._updateTime,this),l.Mediator.on(this.uniqueId+":statechanged",this._checkState,this),l.Mediator.on(this.uniqueId+":playbackready",this._playbackReady,this),l.Mediator.on(this.uniqueId+":onloaded",this._reporLevels,this),l.Mediator.on(this.uniqueId+":levelChanging",this._levelChanging,this),l.Mediator.on(this.uniqueId+":levelChanged",this._levelChange,this),l.Mediator.on(this.uniqueId+":flashready",this._bootstrap,this)}},{key:"stopListening",value:function(){r(Object.getPrototypeOf(t.prototype),"stopListening",this).call(this),l.Mediator.off(this.uniqueId+":progress"),l.Mediator.off(this.uniqueId+":timeupdate"),l.Mediator.off(this.uniqueId+":statechanged"),l.Mediator.off(this.uniqueId+":flashready")}},{key:"_bootstrap",value:function(){this.el.width="100%",this.el.height="100%",this.options.autoPlay&&this.play(),this._setupSettings()}},{key:"_updateTime",value:function(){"live"===this.getPlaybackType()?this.trigger(l.Events.PLAYBACK_TIMEUPDATE,{current:1,total:1},this.name):this.trigger(l.Events.PLAYBACK_TIMEUPDATE,{current:this.el.getPosition(),total:this.el.getDuration()},this.name)}},{key:"_levelChanging",value:function(){this.trigger(l.Events.PLAYBACK_LEVEL_SWITCH_START)}},{key:"_levelChange",value:function(){this.trigger(l.Events.PLAYBACK_LEVEL_SWITCH_END),this.trigger(l.Events.PLAYBACK_BITRATE,{level:this.currentLevel})}},{key:"findLevelBy",value:function(e){var t;return this.levels.forEach(function(i){i.id===e&&(t=i)}),t}},{key:"_setupPlaybackType",value:function(){this._playbackType=this.options.rtmpConfig.playbackType}},{key:"_setupSettings",value:function(){"live"===this.getPlaybackType()?(this.settings.left=["playpause"],this.settings.right=["fullscreen","volume"],this.settings.seekEnabled=!1):(this.settings.left=["playpause","position","duration"],this.settings.right=["fullscreen","volume"]),this.trigger(l.Events.PLAYBACK_SETTINGSUPDATE,this.name)}},{key:"render",value:function(){this.$el.html(this.template({cid:this.cid,swfPath:this.swfPath,playbackId:this.uniqueId,wmode:this.options.rtmpConfig.wmode,scaling:this.options.rtmpConfig.scaling,bufferTime:this.options.rtmpConfig.bufferTime,playbackType:this.options.rtmpConfig.playbackType,startLevel:this.options.rtmpConfig.startLevel})),l.Browser.isIE?(this.$("embed").remove(),l.Browser.isLegacyIE&&this.$el.attr("classid",IE_CLASSID)):l.Browser.isFirefox&&this._setupFirefox(),this.el.id=this.cid;var e=l.Styler.getStyleFor(c["default"]);return this.$el.append(e),this}},{key:"_checkState",value:function(){r(Object.getPrototypeOf(t.prototype),"_checkState",this).call(this),"PLAYING"===this.el.getState()?this.trigger(l.Events.PLAYBACK_PLAY,this.name):"ERROR"===this.el.getState()&&this.trigger(l.Events.PLAYBACK_ERROR,this.name)}},{key:"_playbackReady",value:function(){this._isReadyState=!0,this.trigger(l.Events.PLAYBACK_READY,this.name)}},{key:"_reporLevels",value:function(){this.isDynamicStream&&this.levels&&this.trigger(l.Events.PLAYBACK_LEVELS_AVAILABLE,this.levels,this.options.rtmpConfig.startLevel)}},{key:"swfPath",get:function(){return this.options.rtmpConfig.swfPath}},{key:"currentLevel",get:function(){if(this._isReadyState)return this.el.getCurrentLevel()},set:function(e){this.el.setLevel(e)}},{key:"numLevels",get:function(){if(this._isReadyState)return this.el.getNumLevels()}},{key:"autoSwitchLevels",get:function(){return this.el.isAutoSwitchLevels()}},{key:"levels",get:function(){for(var e=[],t=0;t<this.numLevels;t++){var i=this.el.getBitrateForLevel(t);e.push({id:t,label:i+"Kbps"})}return e}},{key:"isDynamicStream",get:function(){return this.el.isDynamicStream()}}]),t}(l.Flash);t["default"]=f,f.canPlay=function(e){return!(!(e.indexOf("rtmp://")>-1||e.indexOf(".smil")>-1)||!l.Browser.hasFlash)},f.debug=function(e){return console.log(e)},e.exports=t["default"]},/*!*************************!*\
  !*** external "Clappr" ***!
  \*************************/
function(t,i){t.exports=e},/*!***************************!*\
  !*** ./public/flash.html ***!
  \***************************/
function(e,t){e.exports='<param name="movie" value="<%= swfPath %>?inline=1">\n<param name="quality" value="autohigh">\n<param name="swliveconnect" value="true">\n<param name="allowScriptAccess" value="always">\n<param name="allownetworking" value="all">\n<param name="bgcolor" value="#000000">\n<param name="allowFullScreen" value="false">\n<param name="wmode" value="<%= wmode %>">\n<param name="tabindex" value="1">\n<param name=FlashVars value="playbackId=<%= playbackId %>&scaling=<%= scaling %>&bufferTime=<%= bufferTime %>&playbackType=<%= playbackType %>&startLevel=<%= startLevel %>"/>\n<embed\n  name="<%= cid %>"\n  type="application/x-shockwave-flash"\n  disabled="disabled"\n  tabindex="-1"\n  enablecontextmenu="false"\n  allowScriptAccess="always"\n  allownetworking="all"\n  quality="autohigh"\n  pluginspage="http://www.macromedia.com/go/getflashplayer"\n  wmode="<%= wmode %>"\n  swliveconnect="true"\n  allowfullscreen="false"\n  bgcolor="#000000"\n  FlashVars="playbackId=<%= playbackId %>&scaling=<%= scaling %>&bufferTime=<%= bufferTime %>&playbackType=<%= playbackType %>&startLevel=<%= startLevel %>"\n  src="<%= swfPath %>"\n  width="100%"\n  height="100%">\n</embed>'},/*!**********************************************************!*\
  !*** ./~/raw-loader!./~/sass-loader!./public/flash.scss ***!
  \**********************************************************/
function(e,t){e.exports=".clappr-flash-playback[data-flash-playback]{display:block;position:absolute;top:0;left:0;height:100%;width:100%;pointer-events:none}\n"}])});
//# sourceMappingURL=rtmp.min.js.map